<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>feign 使用示例：@Body注解，http请求体 - 魔都水滴</title>
<meta name="description" content="出现接口使用http请求体来传递参数的情况，所以研究了一下feign，发现@Body注解大致可以实现。 虽然说是使用请求体来传递参数，但实质上请求体还是放了json格式的数据。当然，如果不想只局限于json格式，可以将其设置为通用的格式，详见文末。">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://blog.margrop.net/post/feign-demo/">

<meta property="og:site_name" content="魔都水滴">
<meta property="og:title" content="feign 使用示例：@Body注解，http请求体 - 魔都水滴">
<meta property="og:description" content="出现接口使用http请求体来传递参数的情况，所以研究了一下feign，发现@Body注解大致可以实现。 虽然说是使用请求体来传递参数，但实质上请求体还是放了json格式的数据。当然，如果不想只局限于json格式，可以将其设置为通用的格式，详见文末。">
<meta property="og:url" content="https://blog.margrop.net/post/feign-demo/">
<meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="og:image" content="https://blog.margrop.net/images/avatar.png"><meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="feign 使用示例：@Body注解，http请求体 - 魔都水滴">
<meta name="twitter:description" content="出现接口使用http请求体来传递参数的情况，所以研究了一下feign，发现@Body注解大致可以实现。 虽然说是使用请求体来传递参数，但实质上请求体还是放了json格式的数据。当然，如果不想只局限于json格式，可以将其设置为通用的格式，详见文末。"><meta name="twitter:image" content="https://blog.margrop.net/images/avatar.png"><meta property="article:published_time" content="2021-03-05T18:25:23&#43;08:00">
<meta property="article:modified_time" content="2021-03-05T18:25:23&#43;08:00"><meta property="article:tag" content="javascript"><meta property="article:tag" content="feign"><meta property="article:tag" content="openfeign"><meta property="article:tag" content="demo"><meta property="article:tag" content="json"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"魔都水滴"},"dateModified":"2021-03-05T18:25:23+08:00","datePublished":"2021-03-05T18:25:23+08:00","description":"出现接口使用http请求体来传递参数的情况，所以研究了一下feign，发现@Body注解大致可以实现。 虽然说是使用请求体来传递参数，但实质上请求体还是放了json格式的数据。当然，如果不想只局限于json格式，可以将其设置为通用的格式，详见文末。","headline":"feign 使用示例：@Body注解，http请求体","mainEntityOfPage":"https://blog.margrop.net/post/feign-demo/","url":"https://blog.margrop.net/post/feign-demo/"}</script>
    <meta name="baidu-site-verification" content="code-sVFZ8SER59" />
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3J2W592DHJ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-3J2W592DHJ');
    </script>
    
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; line-height: 1.8; }
        h1 { border-bottom: 2px solid #333; padding-bottom: 10px; }
        .meta { color: #666; font-size: 14px; margin-bottom: 20px; }
        .content { line-height: 1.8; }
        .content code { background: #f4f4f4; padding: 2px 5px; border-radius: 3px; }
        .content pre { background: #f4f4f4; padding: 15px; overflow-x: auto; border-radius: 5px; }
        .content img { max-width: 100%; height: auto; }
        .tags { margin-top: 30px; }
        .tag { background: #eee; padding: 2px 8px; border-radius: 3px; font-size: 12px; margin-right: 5px; }
        nav { margin-bottom: 30px; }
        nav a { margin-right: 15px; text-decoration: none; color: #333; }
        nav a:hover { color: #006CFF; }
        a { color: #006CFF; }
    </style>
</head>
<body>
    <nav>
        <a href="/">首页</a>
        <a href="/post/">归档</a>
        <a href="/tag/">标签</a>
    </nav>
    <article>
        <h1>feign 使用示例：@Body注解，http请求体</h1>
        <div class="meta">
            发布时间: 2021-03-05
            
            | 标签: 
            
                
                <a href="/tag/javascript"><span class="tag">javascript</span></a>
            
                
                <a href="/tag/feign"><span class="tag">feign</span></a>
            
                
                <a href="/tag/openfeign"><span class="tag">openfeign</span></a>
            
                
                <a href="/tag/demo"><span class="tag">demo</span></a>
            
                
                <a href="/tag/json"><span class="tag">json</span></a>
            
            
        </div>
        <div class="content">
            <p>出现接口使用http请求体来传递参数的情况，所以研究了一下feign，发现@Body注解大致可以实现。
虽然说是使用请求体来传递参数，但实质上请求体还是放了json格式的数据。当然，如果不想只局限于json格式，可以将其设置为通用的格式，详见文末。</p>
<ul>
<li>maven依赖</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>        <span style="color:#f92672">&lt;dependency&gt;</span><span style="color:#75715e">&lt;!-- 更容易的调用第三方接口 --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;groupId&gt;</span>io.github.openfeign<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;artifactId&gt;</span>feign-slf4j<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;version&gt;</span>11.0<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;dependency&gt;</span><span style="color:#75715e">&lt;!-- 更容易的调用第三方接口 --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;groupId&gt;</span>io.github.openfeign<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;artifactId&gt;</span>feign-okhttp<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;version&gt;</span>11.0<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;dependency&gt;</span><span style="color:#75715e">&lt;!-- 更容易的调用第三方接口 --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;groupId&gt;</span>io.github.openfeign<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;artifactId&gt;</span>feign-gson<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;version&gt;</span>11.0<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>OpenFeign 客户端初始化代码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>        Feign.<span style="color:#a6e22e">builder</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">client</span>(<span style="color:#66d9ef">new</span> OkHttpClient())
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">encoder</span>(<span style="color:#66d9ef">new</span> GsonEncoder())
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">decoder</span>(<span style="color:#66d9ef">new</span> GsonDecoder())
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">logger</span>(<span style="color:#66d9ef">new</span> Slf4jLogger())
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">logLevel</span>(feign.<span style="color:#a6e22e">Logger</span>.<span style="color:#a6e22e">Level</span>.<span style="color:#a6e22e">FULL</span>)
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">target</span>(ApplyV3Api.<span style="color:#a6e22e">class</span>, server);
</span></span></code></pre></div><p>先来一个简单的例子</p>
<h1 id="使用预定义模板方式的请求体">使用预定义模板方式的请求体</h1>
<p>使用@Body注解，定义模板。客户端通过feign向服务端发送请求。
客户端的代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">FeignClientAPI</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@RequestLine</span>(<span style="color:#e6db74">&#34;POST /jsonBody&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Headers</span>(<span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//因为&#39;{}&#39;在模板中有特殊作用（占位符），所以json的首尾中括号需要转义。&#39;{&#39;=&gt;&#39;%7B&#39;，&#39;}&#39;=&gt;&#39;%7D&#39;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Body</span>(<span style="color:#e6db74">&#34;%7B\&#34;id\&#34;: \&#34;{id}\&#34;, \&#34;name\&#34;: \&#34;{name}\&#34;%7D&#34;</span>) 
</span></span><span style="display:flex;"><span>	String <span style="color:#a6e22e">jsonBody</span>(<span style="color:#a6e22e">@Param</span>(<span style="color:#e6db74">&#34;id&#34;</span>) String id, <span style="color:#a6e22e">@Param</span>(<span style="color:#e6db74">&#34;name&#34;</span>) String name);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">```</span>java
</span></span><span style="display:flex;"><span><span style="color:#75715e">//客户端调用</span>
</span></span><span style="display:flex;"><span>feignClient.<span style="color:#a6e22e">jsonBody</span>(<span style="color:#e6db74">&#34;xxId&#34;</span>, <span style="color:#e6db74">&#34;xxName&#34;</span>);
</span></span></code></pre></div><p>服务端的代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RequestMapping</span>(<span style="color:#e6db74">&#34;/jsonBody&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@ResponseBody</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> Object <span style="color:#a6e22e">jsonBody</span>(<span style="color:#a6e22e">@RequestBody</span> JSONObject body){
</span></span><span style="display:flex;"><span>	System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(body);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;success&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>看了上面一个例子，你会感觉很鸡肋，这json还要预定义，这怎么玩嘛。</p>
<h1 id="使用参数模板方式的请求体">使用参数模板方式的请求体</h1>
<h2 id="使用string作为方法参数">使用String作为方法参数</h2>
<p>上面例子我们知道，@Body注解支持&quot;{}&ldquo;形式的占位符，会将方法中的参数填充到模板中，嘿嘿嘿，我们直接将参数当做模板如何，见下
客户端的代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">FeignClientAPI</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@RequestLine</span>(<span style="color:#e6db74">&#34;POST /jsonBody&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Headers</span>(<span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Body</span>(<span style="color:#e6db74">&#34;{body}&#34;</span>)
</span></span><span style="display:flex;"><span>	String <span style="color:#a6e22e">jsonBody</span>(<span style="color:#a6e22e">@Param</span>(<span style="color:#e6db74">&#34;body&#34;</span>) String body);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>发现区别了吗，我们直接给@Body注解定义了一个&rdquo;{body}&quot;。
那么客户端调用时，相应的传参就不是一个个字段了，而是一整个json。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">//客户端调用</span>
</span></span><span style="display:flex;"><span>JSONObject body <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> JSONObject();
</span></span><span style="display:flex;"><span>body.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;id&#34;</span>, <span style="color:#e6db74">&#34;xxId&#34;</span>);
</span></span><span style="display:flex;"><span>body.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;name&#34;</span>, <span style="color:#e6db74">&#34;xxName&#34;</span>);
</span></span><span style="display:flex;"><span>feignClient.<span style="color:#a6e22e">jsonBody</span>(body.<span style="color:#a6e22e">toJSONString</span>());
</span></span></code></pre></div><p>服务端的代码不需要变化。</p>
<h1 id="使用bean作为方法参数tostring">使用Bean作为方法参数（toString)</h1>
<p>feign方法参数使用String类型总感觉诸多不便，通过翻阅代码（详见feign.template.Expressions.SimpleExpression#expand(java.lang.Object, boolean)），发现可以直接使用对象参数，不过使用的对象需要重写toString方法，因为内部实现是调用对象的toString转成字符串处理。</p>
<p>客户端的代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">FeignClientAPI</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@RequestLine</span>(<span style="color:#e6db74">&#34;POST /jsonBody&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Headers</span>(<span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Body</span>(<span style="color:#e6db74">&#34;{body}&#34;</span>)
</span></span><span style="display:flex;"><span>	String <span style="color:#a6e22e">jsonBody</span>(<span style="color:#a6e22e">@Param</span>(<span style="color:#e6db74">&#34;body&#34;</span>) InitBean bean);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@lombok.Data</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InitBean</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> String id;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">private</span> String name;
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">toString</span>(){
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> com.<span style="color:#a6e22e">alibaba</span>.<span style="color:#a6e22e">fastjson</span>.<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">toJSONString</span>(<span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">```</span>
</span></span><span style="display:flex;"><span>客户端调用时<span style="color:#960050;background-color:#1e0010">，</span>直接传Bean<span style="color:#960050;background-color:#1e0010">。</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">```</span>java
</span></span><span style="display:flex;"><span><span style="color:#75715e">//客户端调用</span>
</span></span><span style="display:flex;"><span>InitBean bean <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> InitBean ().<span style="color:#a6e22e">setId</span>(<span style="color:#e6db74">&#34;xxId&#34;</span>).<span style="color:#a6e22e">setName</span>(<span style="color:#e6db74">&#34;xxName&#34;</span>);
</span></span><span style="display:flex;"><span>feignClient.<span style="color:#a6e22e">jsonBody</span>(bean);
</span></span></code></pre></div><p>服务端的代码不需要变化。</p>
<h1 id="再进一步将请求体与其他形式的参数配合使用">再进一步，将请求体与其他形式的参数配合使用</h1>
<p>下面有三段扩展示例，每个示例包括客户端代码和服务端代码，客户端调用的代码你懂的吧，省略了。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">/***************** 扩展一：请求体 + Restful风格URL ******************/</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//客户端代码</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@RequestLine</span>(<span style="color:#e6db74">&#34;POST /jsonBody/{path}&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Headers</span>(<span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Body</span>(<span style="color:#e6db74">&#34;{body}&#34;</span>)
</span></span><span style="display:flex;"><span>	String <span style="color:#a6e22e">jsonBodyAndPath</span>(<span style="color:#a6e22e">@Param</span>(<span style="color:#e6db74">&#34;body&#34;</span>) String body, <span style="color:#a6e22e">@Param</span>(value<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;path&#34;</span>) String path);
</span></span><span style="display:flex;"><span><span style="color:#75715e">//服务端代码</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@RequestMapping</span>(<span style="color:#e6db74">&#34;/jsonBody/{path}&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@ResponseBody</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> Object <span style="color:#a6e22e">jsonBodyAndPath</span>(<span style="color:#a6e22e">@RequestBody</span> JSONObject body, <span style="color:#a6e22e">@PathVariable</span> String path){
</span></span><span style="display:flex;"><span>		System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(body);
</span></span><span style="display:flex;"><span>		System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(path);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;success&#34;</span>;
</span></span><span style="display:flex;"><span>	}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">/***************** 扩展二：请求体 + 请求参数 ******************/</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//客户端代码</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@RequestLine</span>(<span style="color:#e6db74">&#34;POST /jsonBodyWithParam&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Headers</span>(<span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Body</span>(<span style="color:#e6db74">&#34;{body}&#34;</span>)
</span></span><span style="display:flex;"><span>	String <span style="color:#a6e22e">jsonBodyWithParam</span>(<span style="color:#a6e22e">@Param</span>(<span style="color:#e6db74">&#34;body&#34;</span>) String body, <span style="color:#a6e22e">@QueryMap</span> Map map);
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span><span style="color:#75715e">//服务端代码</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@RequestMapping</span>(<span style="color:#e6db74">&#34;/jsonBodyWithParam&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@ResponseBody</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> Object <span style="color:#a6e22e">jsonBodyWithParam</span>(<span style="color:#a6e22e">@RequestBody</span> JSONObject body, <span style="color:#a6e22e">@RequestParam</span> String param){
</span></span><span style="display:flex;"><span>		System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(body);
</span></span><span style="display:flex;"><span>		System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(param);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;success&#34;</span>;
</span></span><span style="display:flex;"><span>	}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">/***************** 扩展三：请求体 + Restful风格URL + 请求参数 ******************/</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//客户端代码</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@RequestLine</span>(<span style="color:#e6db74">&#34;POST /jsonBodyAndPathWithParam/{path}&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Headers</span>(<span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Body</span>(<span style="color:#e6db74">&#34;{body}&#34;</span>)
</span></span><span style="display:flex;"><span>	String <span style="color:#a6e22e">jsonBodyAndPathWithParam</span>(<span style="color:#a6e22e">@Param</span>(<span style="color:#e6db74">&#34;body&#34;</span>) String body, <span style="color:#a6e22e">@Param</span>(value<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;path&#34;</span>) String path, <span style="color:#a6e22e">@QueryMap</span> Map map);
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span><span style="color:#75715e">//服务端代码</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@RequestMapping</span>(<span style="color:#e6db74">&#34;/jsonBodyAndPathWithParam/{path}&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@ResponseBody</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> Object <span style="color:#a6e22e">jsonBodyAndPathWithParam</span>(<span style="color:#a6e22e">@RequestBody</span> JSONObject body, <span style="color:#a6e22e">@PathVariable</span> String path, <span style="color:#a6e22e">@RequestParam</span> String param){
</span></span><span style="display:flex;"><span>		System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(body);
</span></span><span style="display:flex;"><span>		System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(path);
</span></span><span style="display:flex;"><span>		System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(param);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;success&#34;</span>;
</span></span><span style="display:flex;"><span>	}
</span></span></code></pre></div><p>希望上面代码的排版不会把你搞蒙（写一起会比较紧凑吧/捂脸）</p>
<h1 id="扩展一下非json格式的请求体">扩展一下，非json格式的请求体</h1>
<p>上面的示例都是以请求体为json格式数据为大前提，那么，遇到不是json格式的请求体，比如是xml格式的呢？？
这里我是直接将客户端的代码的请求头改为了 @Headers(“Content-Type: text/plain;”)，表示这个请求体为普通文本类型。如下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RequestLine</span>(<span style="color:#e6db74">&#34;POST /stringBody&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">//将请求内容设置为简单文本类型</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Headers</span>(<span style="color:#e6db74">&#34;Content-Type: text/plain;&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Body</span>(<span style="color:#e6db74">&#34;{body}&#34;</span>)
</span></span><span style="display:flex;"><span>String <span style="color:#a6e22e">stringBody</span>(<span style="color:#a6e22e">@Param</span>(<span style="color:#e6db74">&#34;body&#34;</span>) String body);
</span></span></code></pre></div><p>相应的，服务端代码使用String做接收参数，来接收请求体的内容。服务端接收到string后，转化为相应的类型</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RequestMapping</span>(<span style="color:#e6db74">&#34;/stringBody&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@ResponseBody</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> Object <span style="color:#a6e22e">stringBody</span>(<span style="color:#a6e22e">@RequestBody</span> String body) <span style="color:#66d9ef">throws</span> DocumentException {
</span></span><span style="display:flex;"><span>	System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(body);
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//string 转 json</span>
</span></span><span style="display:flex;"><span>	JSONObject jsonObject <span style="color:#f92672">=</span> com.<span style="color:#a6e22e">alibaba</span>.<span style="color:#a6e22e">fastjson</span>.<span style="color:#a6e22e">JSONObject</span>.<span style="color:#a6e22e">parseObject</span>(body);
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//或者 string 转 xml</span>
</span></span><span style="display:flex;"><span>	Document document <span style="color:#f92672">=</span> org.<span style="color:#a6e22e">dom4j</span>.<span style="color:#a6e22e">DocumentHelper</span>.<span style="color:#a6e22e">parseText</span>(body);
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//或其他...</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;success&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>基本是上述思路，还没有发掘其他方式实现，如果更好的实现方式，感谢分享，一起探讨。</p>
<h1 id="参考文章">参考文章</h1>
<p><a href="https://blog.csdn.net/qq_31772441/article/details/100176834">https://blog.csdn.net/qq_31772441/article/details/100176834</a>
<a href="https://blog.csdn.net/sinat_36553913/article/details/104469418">https://blog.csdn.net/sinat_36553913/article/details/104469418</a>
<a href="https://blog.csdn.net/sinat_36553913/article/details/104527072">https://blog.csdn.net/sinat_36553913/article/details/104527072</a>
<a href="https://www.jianshu.com/p/0834508b7a6d">https://www.jianshu.com/p/0834508b7a6d</a></p>
        </div>
    </article>
    
    
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js"></script>
<div id="gitalk-container" style="margin-top:40px"></div>
<script>
  (function(){
    var gitalk = new Gitalk({
      clientID: '3181fd94e501cc5db0ad',
      clientSecret: 'af1dab79dae02c69296e6615bfcecf47fc8615ee',
      repo: 'margropcomment.margrop.io',
      owner: 'margrop',
      admin: ["margrop"],
      
      id: '\/post\/feign-demo\/',
      
      distractionFreeMode: false
    });
    gitalk.render('gitalk-container');
  })();
</script>
  



    <script type="text/javascript" src="https://js.users.51.la/21044367.js"></script>
    <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
    <script>LA.init({id: "1vVTUWl7zoRjnKXi",ck: "1vVTUWl7zoRjnKXi"})</script>
    <script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script>
    <script>
      new LingQue.Monitor().init({id:"202teQt8THXwqyve"});
    </script>
</body>
</html>
