<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>自定义LEDE路由器KoolProxyR屏蔽广告规则，20200705 | 魔都水滴</title>
<link rel="shortcut icon" href="https://blog.margrop.net/favicon.ico?v=1772278123220">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://blog.margrop.net/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="自定义LEDE路由器KoolProxyR屏蔽广告规则，20200705 | 魔都水滴 - Atom Feed" href="https://blog.margrop.net/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">


<script async src="https://www.googletagmanager.com/gtag/js?id=G-3J2W592DHJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3J2W592DHJ');
</script>


<script type="text/javascript" src="https://js.users.51.la/21044367.js"></script>
<script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id: "1vVTUWl7zoRjnKXi",ck: "1vVTUWl7zoRjnKXi"})</script>
<script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script>
<script>
  new LingQue.Monitor().init({id:"202teQt8THXwqyve"});
</script>
    <meta name="description" content="如何安装KoolProxyR

参考KoolProxyR项目官网


在SSH中执行如下代码实现在线安装。（请全部复制）

wget -4 -O /tmp/KoolProxyR_install.sh https://shaoxia1991...." />
    <meta name="keywords" content="koolproxy,koolproxyr,lede,router,adblock,rules,广告屏蔽,软路由" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://blog.margrop.net">
  <img class="avatar" src="https://blog.margrop.net/images/avatar.png?v=1772278123220" alt="">
  </a>
  <h1 class="site-title">
    魔都水滴
  </h1>
  <p class="site-description">
    A Programmer, A Javaer, A Father, A Geeker, A Huster, A Acmer, A Wower, A Player
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
      
        <a href="https://download.margrop.net" class="menu" target="_blank">
          下载
        </a>
      
    
      
        <a href="/post/favorites" class="menu">
          Link
        </a>
      
    
      
        <a href="/post/github-project-stars" class="menu">
          Github
        </a>
      
    
      
        <a href="https://github-mirrors.margrop.net" class="menu" target="_blank">
          Github加速
        </a>
      
    
      
        <a href="https://docker-mirrors.margrop.net" class="menu" target="_blank">
          Docker加速
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/margrop" target="_blank">
          <i class="ri-github-line"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              自定义LEDE路由器KoolProxyR屏蔽广告规则，20200705
            </h2>
            <div class="post-info">
              <span>
                2021-01-15
              </span>
              <span>
                5 min read
              </span>
              
                <a href="https://blog.margrop.net/tag/EYGOZr77q/" class="post-tag">
                  # koolproxy
                </a>
              
                <a href="https://blog.margrop.net/tag/Lppj6Dd94J/" class="post-tag">
                  # koolproxyr
                </a>
              
                <a href="https://blog.margrop.net/tag/AYFCVr1hG/" class="post-tag">
                  # lede
                </a>
              
                <a href="https://blog.margrop.net/tag/Fn1pe4dPit/" class="post-tag">
                  # router
                </a>
              
                <a href="https://blog.margrop.net/tag/cjSPUg8HYU/" class="post-tag">
                  # adblock
                </a>
              
                <a href="https://blog.margrop.net/tag/hcSmb8xhUr/" class="post-tag">
                  # rules
                </a>
              
                <a href="https://blog.margrop.net/tag/P2UyD-ns-J/" class="post-tag">
                  # 广告屏蔽
                </a>
              
                <a href="https://blog.margrop.net/tag/Hc6tRHLw1F/" class="post-tag">
                  # 软路由
                </a>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <h1 id="如何安装koolproxyr">如何安装KoolProxyR</h1>
<ul>
<li>参考<a href="https://github.com/user1121114685/koolproxyR">KoolProxyR项目官网</a></li>
</ul>
<blockquote>
<p>在SSH中执行如下代码实现在线安装。（请全部复制）</p>
</blockquote>
<pre><code>wget -4 -O /tmp/KoolProxyR_install.sh https://shaoxia1991.coding.net/p/koolproxyr/d/koolproxyr/git/raw/master/KoolProxyR_install.sh &amp;&amp; chmod 777 /tmp/KoolProxyR_install.sh &amp;&amp; sh /tmp/KoolProxyR_install.sh
</code></pre>
<h1 id="广告屏蔽规则">广告屏蔽规则</h1>
<blockquote>
<p>下面是我自己使用的路由器广告屏蔽规则<br>
基于软路由<code>LEDE</code>，<code>KoolProxyR</code>的自定义规则中使用。</p>
</blockquote>
<!-- more -->
<pre><code>! https://gist.github.com/itspig/e22bd240cff35fbb4b29fafd2539de27
api.ad.xiaomi.com
sdkconfig.ad.xiaomi.com
ad.mi.com
ad.xiaomi.com
ad1.xiaomi.com

adv.sec.miui.com
test.ad.xiaomi.com
new.api.ad.xiaomi.com

cdn.ad.xiaomi.com
e.ad.xiaomi.com
test.new.api.ad.xiaomi.com

ssp.ad.xiaomi.com
o2o.api.xiaomi.com

! tcpdump

api.cupid.ptqy.gitv.tv

! others

stat.pandora.xiaomi.com
upgrade.mishop.pandora.xiaomi.com
logonext.tv.kuyun.com
config.kuyun.com
api.io.mi.com
mishop.pandora.xiaomi.com
dvb.pandora.xiaomi.com
de.pandora.xiaomi.com
data.mistat.xiaomi.com
jellyfish.pandora.xiaomi.com
!gallery.pandora.xiaomi.com
o2o.api.xiaomi.com
bss.pandora.xiaomi.com
gvod.aiseejapp.atianqi.com

!屏蔽自动更新和安装有品
package.cdn.pandora.xiaomi.com
package.box.xiaomi.com
ota.cdn.pandora.xiaomi.com

!nPlayer Lite屏蔽广告
rayjump.net
adservice.google.com
ads.yahoo.com
mzstatic.com
app-measurement.com
moatads.com
play.googleapis.com
iid.googleapis.com

!iPad屏蔽广告
googlevideo.com
googleusercontent.com
gstatic.com
googleads.g.doubleclick.net
googlesyndication.com
g.doubleclick.net
snssdk.com
sgsnssdk.com
app-measurement.com
pstatp.com
ctobsnssdk.com
umeng.com

!乐播投屏广告
adeng.hpplay.cn
adcdn.hpplay.cn
sl.hpplay.cn
rp.hpplay.cn
hpplay.com.cn

!小米相关广告
a.stat.xiaomi.com
a.union.mi.com
abtest.mistat.xiaomi.com
adinfo.ra1.xlmc.sec.miui.com
adv.sec.miui.com
api.ad.xiaomi.com
api.ra2.xlmc.sec.miui.com
api.tuisong.baidu.com
api.tw06.xlmc.sec.miui.com
app01.nodes.gslb.mi-idc.com
app02.nodes.gslb.mi-idc.com
app03.nodes.gslb.mi-idc.com
applog.uc.cn
beha.ksmobile.com
bss.pandora.xiaomi.com
calopenupdate.comm.miui.com
cdn.ad.xiaomi.com
cm.p4p.cn.yahoo.com
cm066.getui.igexin.com
connect.rom.miui.com
data.mistat.xiaomi.com
e.ad.xiaomi.com
etl.xlmc.sandai.net
fcanr.tracking.miui.com
fclick.baidu.com
get.sogou.com
hm.xiaomi.com
hub5pn.wap.sandai.net
idx.m.hub.sandai.net
image.box.xiaomi.com
info.analysis.kp.sec.miui.com
info.sec.miui.com
logupdate.avlyun.sec.miui.com
m.bss.pandora.xiaomi.com
m.irs01.com
m.sjzhushou.com
master.wap.dphub.sandai.net
mdap.alipaylog.com
migc.g.mi.com
migcreport.g.mi.com
migrate.driveapi.micloud.xiaomi.net
mis.g.mi.com
mlog.search.xiaomi.net
new.api.ad.xiaomi.com
notice.game.xiaomi.com
nsclick.baidu.com
o2o.api.xiaomi.com
p.alimama.com
pdc.micloud.xiaomi.net
ppurifier.game.xiaomi.com
pre.api.tw06.xlmc.sandai.net
r.browser.miui.com
reader.browser.miui.com
report.adview.cn
resolver.gslb.mi-idc.com
resolver.msg.xiaomi.net
sa.tuisong.baidu.com
sa3.tuisong.baidu.com
sdk.open.phone.igexin.com
sdk.open.talk.gepush.com
sdk.open.talk.igexin.com
sdkconfig.ad.xiaomi.com
sec-cdn.static.xiaomi.net
sec.resource.xiaomi.net
security.browser.miui.com
sg.a.stat.mi.com
staging.admin.e.mi.com
test.ad.xiaomi.com
test.api.xlmc.sandai.net
test.e.ad.xiaomi.com
test.new.api.ad.xiaomi.com
tracking.miui.com
tw13b093.sandai.net
union.dbba.cn
update.avlyun.sec.miui.com
www.adview.cn
yun.rili.cn
zhwnlapi.etouch.cn
api.comm.miui.com

!小米电视屏蔽广告规则
!https://blog.csdn.net/moshowgame/article/details/79907926
stat.pandora.xiaomi.com
upgrade.mishop.pandora.xiaomi.com
logonext.tv.kuyun.com
config.kuyun.com
api.io.mi.com
mishop.pandora.xiaomi.com
dvb.pandora.xiaomi.com
api.ad.xiaomi.com
de.pandora.xiaomi.com
data.mistat.xiaomi.com
jellyfish.pandora.xiaomi.com
gallery.pandora.xiaomi.com
o2o.api.xiaomi.com
bss.pandora.xiaomi.com
gvod.aiseejapp.atianqi.com
ad.mi.com
ad.xiaomi.com
ad1.xiaomi.com
sdkconfig.ad.xiaomi.com
staging.ai.api.xiaomi.com
b.netcheck.gallery.pandora.xiaomi.com
f1.market.xiaomi.com
f2.market.xiaomi.com
f3.market.xiaomi.com
f4.market.xiaomi.com
f5.market.xiaomi.com
ad.doubleclick.net
v.admaster.com.cn
f1.market.mi-img.com
f2.market.mi-img.com
f3.market.mi-img.com
f4.market.mi-img.com
f5.market.mi-img.com
g.dtv.cn.miaozhan.com
ad.xiaomi.com
ad1.xiaomi.com
new.api.ad.xiaomi.com
api.ad.xiaomi.com
o2o.api.xiaomi.com
</code></pre>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85koolproxyr">如何安装KoolProxyR</a></li>
<li><a href="#%E5%B9%BF%E5%91%8A%E5%B1%8F%E8%94%BD%E8%A7%84%E5%88%99">广告屏蔽规则</a></li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://blog.margrop.net/post/how-to-use-n2n-windows-compile/">
              <h3 class="post-title">
                如何使用Windows运行N2N-编译篇
              </h3>
            </a>
          </div>
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '3181fd94e501cc5db0ad',
    clientSecret: 'af1dab79dae02c69296e6615bfcecf47fc8615ee',
    repo: 'margropcomment.margrop.io',
    owner: 'margrop',
    admin: ['margrop'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://blog.margrop.net/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>
<script type="text/javascript" src="https://js.users.51.la/21044367.js"></script>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
