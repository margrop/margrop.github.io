<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Spring Boot &#43; Undertow上传文件找不到临时目录 - 魔都水滴</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="baidu-site-verification" content="code-sVFZ8SER59" />
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3J2W592DHJ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-3J2W592DHJ');
    </script>
    
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; line-height: 1.8; }
        h1 { border-bottom: 2px solid #333; padding-bottom: 10px; }
        .meta { color: #666; font-size: 14px; margin-bottom: 20px; }
        .content { line-height: 1.8; }
        .content code { background: #f4f4f4; padding: 2px 5px; border-radius: 3px; }
        .content pre { background: #f4f4f4; padding: 15px; overflow-x: auto; border-radius: 5px; }
        .content img { max-width: 100%; height: auto; }
        .tags { margin-top: 30px; }
        .tag { background: #eee; padding: 2px 8px; border-radius: 3px; font-size: 12px; margin-right: 5px; }
        nav { margin-bottom: 30px; }
        nav a { margin-right: 15px; text-decoration: none; color: #333; }
        nav a:hover { color: #006CFF; }
        a { color: #006CFF; }
    </style>
</head>
<body>
    <nav>
        <a href="/">首页</a>
        <a href="/post/">归档</a>
        <a href="/tag/">标签</a>
    </nav>
    <article>
        <h1>Spring Boot &#43; Undertow上传文件找不到临时目录</h1>
        <div class="meta">
            发布时间: 2021-03-27
            
            | 标签: 
            
                
                <a href="/tag/java"><span class="tag">java</span></a>
            
                
                <a href="/tag/springboot"><span class="tag">springboot</span></a>
            
                
                <a href="/tag/undertow"><span class="tag">undertow</span></a>
            
            
        </div>
        <div class="content">
            <h1 id="问题出现">问题出现</h1>
<p>前2天，公司的 SpringBoot 项目突然出现了，无法上传 Excel 文件的问题。</p>
<p>经过查看 Java 日志，发现出现了大量的异常：<code>java.nio.file.NoSuchFileException: /tmp/undertow.12020.9432679758080410942/undertow17157208698492118168upload</code></p>
<p>详细异常信息如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">multipart</span>.<span style="color:#a6e22e">MultipartException</span>: Failed to parse multipart servlet request; nested exception is java.<span style="color:#a6e22e">lang</span>.<span style="color:#a6e22e">RuntimeException</span>: java.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">NoSuchFileException</span>: <span style="color:#f92672">/</span>tmp<span style="color:#f92672">/</span>undertow.<span style="color:#a6e22e">12020</span>.<span style="color:#a6e22e">9432679758080410942</span><span style="color:#f92672">/</span>undertow17157208698492118168upload
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">multipart</span>.<span style="color:#a6e22e">support</span>.<span style="color:#a6e22e">StandardMultipartHttpServletRequest</span>.<span style="color:#a6e22e">handleParseFailure</span>(StandardMultipartHttpServletRequest.<span style="color:#a6e22e">java</span>:124)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">multipart</span>.<span style="color:#a6e22e">support</span>.<span style="color:#a6e22e">StandardMultipartHttpServletRequest</span>.<span style="color:#a6e22e">parseRequest</span>(StandardMultipartHttpServletRequest.<span style="color:#a6e22e">java</span>:115)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">multipart</span>.<span style="color:#a6e22e">support</span>.<span style="color:#a6e22e">StandardMultipartHttpServletRequest</span>.<span style="color:#f92672">&lt;</span>init<span style="color:#f92672">&gt;</span>(StandardMultipartHttpServletRequest.<span style="color:#a6e22e">java</span>:88)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">multipart</span>.<span style="color:#a6e22e">support</span>.<span style="color:#a6e22e">StandardServletMultipartResolver</span>.<span style="color:#a6e22e">resolveMultipart</span>(StandardServletMultipartResolver.<span style="color:#a6e22e">java</span>:87)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">DispatcherServlet</span>.<span style="color:#a6e22e">checkMultipart</span>(DispatcherServlet.<span style="color:#a6e22e">java</span>:1199)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">DispatcherServlet</span>.<span style="color:#a6e22e">doDispatch</span>(DispatcherServlet.<span style="color:#a6e22e">java</span>:1033)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">DispatcherServlet</span>.<span style="color:#a6e22e">doService</span>(DispatcherServlet.<span style="color:#a6e22e">java</span>:961)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">FrameworkServlet</span>.<span style="color:#a6e22e">processRequest</span>(FrameworkServlet.<span style="color:#a6e22e">java</span>:1006)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">FrameworkServlet</span>.<span style="color:#a6e22e">doPost</span>(FrameworkServlet.<span style="color:#a6e22e">java</span>:909)
</span></span><span style="display:flex;"><span>	at javax.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HttpServlet</span>.<span style="color:#a6e22e">service</span>(HttpServlet.<span style="color:#a6e22e">java</span>:517)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">FrameworkServlet</span>.<span style="color:#a6e22e">service</span>(FrameworkServlet.<span style="color:#a6e22e">java</span>:883)
</span></span><span style="display:flex;"><span>	at javax.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HttpServlet</span>.<span style="color:#a6e22e">service</span>(HttpServlet.<span style="color:#a6e22e">java</span>:584)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">ServletHandler</span>.<span style="color:#a6e22e">handleRequest</span>(ServletHandler.<span style="color:#a6e22e">java</span>:74)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">FilterHandler$FilterChainImpl</span>.<span style="color:#a6e22e">doFilter</span>(FilterHandler.<span style="color:#a6e22e">java</span>:129)
</span></span><span style="display:flex;"><span>	at me.<span style="color:#a6e22e">ymq</span>.<span style="color:#a6e22e">starterapi</span>.<span style="color:#a6e22e">filter</span>.<span style="color:#a6e22e">ReplaceStreamFilter</span>.<span style="color:#a6e22e">doFilter</span>(ReplaceStreamFilter.<span style="color:#a6e22e">java</span>:33)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">ManagedFilter</span>.<span style="color:#a6e22e">doFilter</span>(ManagedFilter.<span style="color:#a6e22e">java</span>:61)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">FilterHandler$FilterChainImpl</span>.<span style="color:#a6e22e">doFilter</span>(FilterHandler.<span style="color:#a6e22e">java</span>:131)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">filter</span>.<span style="color:#a6e22e">RequestContextFilter</span>.<span style="color:#a6e22e">doFilterInternal</span>(RequestContextFilter.<span style="color:#a6e22e">java</span>:100)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">filter</span>.<span style="color:#a6e22e">OncePerRequestFilter</span>.<span style="color:#a6e22e">doFilter</span>(OncePerRequestFilter.<span style="color:#a6e22e">java</span>:119)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">ManagedFilter</span>.<span style="color:#a6e22e">doFilter</span>(ManagedFilter.<span style="color:#a6e22e">java</span>:61)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">FilterHandler$FilterChainImpl</span>.<span style="color:#a6e22e">doFilter</span>(FilterHandler.<span style="color:#a6e22e">java</span>:131)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">filter</span>.<span style="color:#a6e22e">FormContentFilter</span>.<span style="color:#a6e22e">doFilterInternal</span>(FormContentFilter.<span style="color:#a6e22e">java</span>:93)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">filter</span>.<span style="color:#a6e22e">OncePerRequestFilter</span>.<span style="color:#a6e22e">doFilter</span>(OncePerRequestFilter.<span style="color:#a6e22e">java</span>:119)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">ManagedFilter</span>.<span style="color:#a6e22e">doFilter</span>(ManagedFilter.<span style="color:#a6e22e">java</span>:61)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">FilterHandler$FilterChainImpl</span>.<span style="color:#a6e22e">doFilter</span>(FilterHandler.<span style="color:#a6e22e">java</span>:131)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">boot</span>.<span style="color:#a6e22e">actuate</span>.<span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">WebMvcMetricsFilter</span>.<span style="color:#a6e22e">doFilterInternal</span>(WebMvcMetricsFilter.<span style="color:#a6e22e">java</span>:93)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">filter</span>.<span style="color:#a6e22e">OncePerRequestFilter</span>.<span style="color:#a6e22e">doFilter</span>(OncePerRequestFilter.<span style="color:#a6e22e">java</span>:119)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">ManagedFilter</span>.<span style="color:#a6e22e">doFilter</span>(ManagedFilter.<span style="color:#a6e22e">java</span>:61)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">FilterHandler$FilterChainImpl</span>.<span style="color:#a6e22e">doFilter</span>(FilterHandler.<span style="color:#a6e22e">java</span>:131)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">filter</span>.<span style="color:#a6e22e">CharacterEncodingFilter</span>.<span style="color:#a6e22e">doFilterInternal</span>(CharacterEncodingFilter.<span style="color:#a6e22e">java</span>:201)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">filter</span>.<span style="color:#a6e22e">OncePerRequestFilter</span>.<span style="color:#a6e22e">doFilter</span>(OncePerRequestFilter.<span style="color:#a6e22e">java</span>:119)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">ManagedFilter</span>.<span style="color:#a6e22e">doFilter</span>(ManagedFilter.<span style="color:#a6e22e">java</span>:61)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">FilterHandler$FilterChainImpl</span>.<span style="color:#a6e22e">doFilter</span>(FilterHandler.<span style="color:#a6e22e">java</span>:131)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">FilterHandler</span>.<span style="color:#a6e22e">handleRequest</span>(FilterHandler.<span style="color:#a6e22e">java</span>:84)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">security</span>.<span style="color:#a6e22e">ServletSecurityRoleHandler</span>.<span style="color:#a6e22e">handleRequest</span>(ServletSecurityRoleHandler.<span style="color:#a6e22e">java</span>:62)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">ServletChain$1</span>.<span style="color:#a6e22e">handleRequest</span>(ServletChain.<span style="color:#a6e22e">java</span>:68)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">ServletDispatchingHandler</span>.<span style="color:#a6e22e">handleRequest</span>(ServletDispatchingHandler.<span style="color:#a6e22e">java</span>:36)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">RedirectDirHandler</span>.<span style="color:#a6e22e">handleRequest</span>(RedirectDirHandler.<span style="color:#a6e22e">java</span>:68)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">security</span>.<span style="color:#a6e22e">SSLInformationAssociationHandler</span>.<span style="color:#a6e22e">handleRequest</span>(SSLInformationAssociationHandler.<span style="color:#a6e22e">java</span>:132)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">security</span>.<span style="color:#a6e22e">ServletAuthenticationCallHandler</span>.<span style="color:#a6e22e">handleRequest</span>(ServletAuthenticationCallHandler.<span style="color:#a6e22e">java</span>:57)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">PredicateHandler</span>.<span style="color:#a6e22e">handleRequest</span>(PredicateHandler.<span style="color:#a6e22e">java</span>:43)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">security</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">AbstractConfidentialityHandler</span>.<span style="color:#a6e22e">handleRequest</span>(AbstractConfidentialityHandler.<span style="color:#a6e22e">java</span>:46)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">security</span>.<span style="color:#a6e22e">ServletConfidentialityConstraintHandler</span>.<span style="color:#a6e22e">handleRequest</span>(ServletConfidentialityConstraintHandler.<span style="color:#a6e22e">java</span>:64)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">security</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">AuthenticationMechanismsHandler</span>.<span style="color:#a6e22e">handleRequest</span>(AuthenticationMechanismsHandler.<span style="color:#a6e22e">java</span>:60)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">security</span>.<span style="color:#a6e22e">CachedAuthenticatedSessionHandler</span>.<span style="color:#a6e22e">handleRequest</span>(CachedAuthenticatedSessionHandler.<span style="color:#a6e22e">java</span>:77)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">security</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">AbstractSecurityContextAssociationHandler</span>.<span style="color:#a6e22e">handleRequest</span>(AbstractSecurityContextAssociationHandler.<span style="color:#a6e22e">java</span>:43)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">PredicateHandler</span>.<span style="color:#a6e22e">handleRequest</span>(PredicateHandler.<span style="color:#a6e22e">java</span>:43)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">SendErrorPageHandler</span>.<span style="color:#a6e22e">handleRequest</span>(SendErrorPageHandler.<span style="color:#a6e22e">java</span>:52)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">PredicateHandler</span>.<span style="color:#a6e22e">handleRequest</span>(PredicateHandler.<span style="color:#a6e22e">java</span>:43)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">ServletInitialHandler</span>.<span style="color:#a6e22e">handleFirstRequest</span>(ServletInitialHandler.<span style="color:#a6e22e">java</span>:269)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">ServletInitialHandler</span>.<span style="color:#a6e22e">access$100</span>(ServletInitialHandler.<span style="color:#a6e22e">java</span>:78)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">ServletInitialHandler$2</span>.<span style="color:#a6e22e">call</span>(ServletInitialHandler.<span style="color:#a6e22e">java</span>:133)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">ServletInitialHandler$2</span>.<span style="color:#a6e22e">call</span>(ServletInitialHandler.<span style="color:#a6e22e">java</span>:130)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">ServletRequestContextThreadSetupAction$1</span>.<span style="color:#a6e22e">call</span>(ServletRequestContextThreadSetupAction.<span style="color:#a6e22e">java</span>:48)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">ContextClassLoaderSetupAction$1</span>.<span style="color:#a6e22e">call</span>(ContextClassLoaderSetupAction.<span style="color:#a6e22e">java</span>:43)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">ServletInitialHandler</span>.<span style="color:#a6e22e">dispatchRequest</span>(ServletInitialHandler.<span style="color:#a6e22e">java</span>:249)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">ServletInitialHandler</span>.<span style="color:#a6e22e">access$000</span>(ServletInitialHandler.<span style="color:#a6e22e">java</span>:78)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">ServletInitialHandler$1</span>.<span style="color:#a6e22e">handleRequest</span>(ServletInitialHandler.<span style="color:#a6e22e">java</span>:99)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">Connectors</span>.<span style="color:#a6e22e">executeRootHandler</span>(Connectors.<span style="color:#a6e22e">java</span>:387)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">HttpServerExchange$1</span>.<span style="color:#a6e22e">run</span>(HttpServerExchange.<span style="color:#a6e22e">java</span>:841)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">jboss</span>.<span style="color:#a6e22e">threads</span>.<span style="color:#a6e22e">ContextClassLoaderSavingRunnable</span>.<span style="color:#a6e22e">run</span>(ContextClassLoaderSavingRunnable.<span style="color:#a6e22e">java</span>:35)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">jboss</span>.<span style="color:#a6e22e">threads</span>.<span style="color:#a6e22e">EnhancedQueueExecutor</span>.<span style="color:#a6e22e">safeRun</span>(EnhancedQueueExecutor.<span style="color:#a6e22e">java</span>:2019)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">jboss</span>.<span style="color:#a6e22e">threads</span>.<span style="color:#a6e22e">EnhancedQueueExecutor$ThreadBody</span>.<span style="color:#a6e22e">doRunTask</span>(EnhancedQueueExecutor.<span style="color:#a6e22e">java</span>:1558)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">jboss</span>.<span style="color:#a6e22e">threads</span>.<span style="color:#a6e22e">EnhancedQueueExecutor$ThreadBody</span>.<span style="color:#a6e22e">run</span>(EnhancedQueueExecutor.<span style="color:#a6e22e">java</span>:1449)
</span></span><span style="display:flex;"><span>	at java.<span style="color:#a6e22e">base</span><span style="color:#f92672">/</span>java.<span style="color:#a6e22e">lang</span>.<span style="color:#a6e22e">Thread</span>.<span style="color:#a6e22e">run</span>(Thread.<span style="color:#a6e22e">java</span>:844)
</span></span><span style="display:flex;"><span>Caused by: java.<span style="color:#a6e22e">lang</span>.<span style="color:#a6e22e">RuntimeException</span>: java.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">NoSuchFileException</span>: <span style="color:#f92672">/</span>tmp<span style="color:#f92672">/</span>undertow.<span style="color:#a6e22e">12020</span>.<span style="color:#a6e22e">9432679758080410942</span><span style="color:#f92672">/</span>undertow17157208698492118168upload
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">form</span>.<span style="color:#a6e22e">MultiPartParserDefinition$MultiPartUploadHandler</span>.<span style="color:#a6e22e">beginPart</span>(MultiPartParserDefinition.<span style="color:#a6e22e">java</span>:261)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">util</span>.<span style="color:#a6e22e">MultipartParser$ParseState</span>.<span style="color:#a6e22e">headerName</span>(MultipartParser.<span style="color:#a6e22e">java</span>:208)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">util</span>.<span style="color:#a6e22e">MultipartParser$ParseState</span>.<span style="color:#a6e22e">parse</span>(MultipartParser.<span style="color:#a6e22e">java</span>:123)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">form</span>.<span style="color:#a6e22e">MultiPartParserDefinition$MultiPartUploadHandler</span>.<span style="color:#a6e22e">parseBlocking</span>(MultiPartParserDefinition.<span style="color:#a6e22e">java</span>:232)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">spec</span>.<span style="color:#a6e22e">HttpServletRequestImpl</span>.<span style="color:#a6e22e">parseFormData</span>(HttpServletRequestImpl.<span style="color:#a6e22e">java</span>:857)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">spec</span>.<span style="color:#a6e22e">HttpServletRequestImpl</span>.<span style="color:#a6e22e">loadParts</span>(HttpServletRequestImpl.<span style="color:#a6e22e">java</span>:579)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">servlet</span>.<span style="color:#a6e22e">spec</span>.<span style="color:#a6e22e">HttpServletRequestImpl</span>.<span style="color:#a6e22e">getParts</span>(HttpServletRequestImpl.<span style="color:#a6e22e">java</span>:530)
</span></span><span style="display:flex;"><span>	at org.<span style="color:#a6e22e">springframework</span>.<span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">multipart</span>.<span style="color:#a6e22e">support</span>.<span style="color:#a6e22e">StandardMultipartHttpServletRequest</span>.<span style="color:#a6e22e">parseRequest</span>(StandardMultipartHttpServletRequest.<span style="color:#a6e22e">java</span>:95)
</span></span><span style="display:flex;"><span>	... 63 common frames omitted
</span></span><span style="display:flex;"><span>Caused by: java.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">NoSuchFileException</span>: <span style="color:#f92672">/</span>tmp<span style="color:#f92672">/</span>undertow.<span style="color:#a6e22e">12020</span>.<span style="color:#a6e22e">9432679758080410942</span><span style="color:#f92672">/</span>undertow17157208698492118168upload
</span></span><span style="display:flex;"><span>	at java.<span style="color:#a6e22e">base</span><span style="color:#f92672">/</span>sun.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">UnixException</span>.<span style="color:#a6e22e">translateToIOException</span>(UnixException.<span style="color:#a6e22e">java</span>:92)
</span></span><span style="display:flex;"><span>	at java.<span style="color:#a6e22e">base</span><span style="color:#f92672">/</span>sun.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">UnixException</span>.<span style="color:#a6e22e">rethrowAsIOException</span>(UnixException.<span style="color:#a6e22e">java</span>:111)
</span></span><span style="display:flex;"><span>	at java.<span style="color:#a6e22e">base</span><span style="color:#f92672">/</span>sun.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">UnixException</span>.<span style="color:#a6e22e">rethrowAsIOException</span>(UnixException.<span style="color:#a6e22e">java</span>:116)
</span></span><span style="display:flex;"><span>	at java.<span style="color:#a6e22e">base</span><span style="color:#f92672">/</span>sun.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">UnixFileSystemProvider</span>.<span style="color:#a6e22e">newByteChannel</span>(UnixFileSystemProvider.<span style="color:#a6e22e">java</span>:215)
</span></span><span style="display:flex;"><span>	at java.<span style="color:#a6e22e">base</span><span style="color:#f92672">/</span>java.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">newByteChannel</span>(Files.<span style="color:#a6e22e">java</span>:369)
</span></span><span style="display:flex;"><span>	at java.<span style="color:#a6e22e">base</span><span style="color:#f92672">/</span>java.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">createFile</span>(Files.<span style="color:#a6e22e">java</span>:640)
</span></span><span style="display:flex;"><span>	at java.<span style="color:#a6e22e">base</span><span style="color:#f92672">/</span>java.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">TempFileHelper</span>.<span style="color:#a6e22e">create</span>(TempFileHelper.<span style="color:#a6e22e">java</span>:137)
</span></span><span style="display:flex;"><span>	at java.<span style="color:#a6e22e">base</span><span style="color:#f92672">/</span>java.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">TempFileHelper</span>.<span style="color:#a6e22e">createTempFile</span>(TempFileHelper.<span style="color:#a6e22e">java</span>:160)
</span></span><span style="display:flex;"><span>	at java.<span style="color:#a6e22e">base</span><span style="color:#f92672">/</span>java.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Files</span>.<span style="color:#a6e22e">createTempFile</span>(Files.<span style="color:#a6e22e">java</span>:860)
</span></span><span style="display:flex;"><span>	at io.<span style="color:#a6e22e">undertow</span>.<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">handlers</span>.<span style="color:#a6e22e">form</span>.<span style="color:#a6e22e">MultiPartParserDefinition$MultiPartUploadHandler</span>.<span style="color:#a6e22e">beginPart</span>(MultiPartParserDefinition.<span style="color:#a6e22e">java</span>:254)
</span></span><span style="display:flex;"><span>	... 70 common frames omitted
</span></span></code></pre></div><h1 id="错误原因">错误原因</h1>
<p>在Linux系统中，Spring Boot应用以<code>java -jar</code>命令启动时，会在操作系统的/tmp目录下生成一个tomcat（或undertow），上传的文件先要转换成临时文件保存在这个文件夹下面。由于临时/tmp目录下的文件，在长时间（10天）没有使用的情况下，就会被系统机制自动删除掉。所以如果系统长时间没有使用到临时文件夹，就可能导致上面这个问题。</p>
<h1 id="解决方法">解决方法</h1>
<h2 id="方法一临时解决方案">方法一：临时解决方案</h2>
<p>重启SpringBoot应用，即可马上解决问题。</p>
<h2 id="方法二修改-applicationyml">方法二：修改 application.yml</h2>
<p>在配置文件<code>applicaiton.yml</code>里加入配置<code>spring.servlet.multipart.location</code>，设置为固定的上传文件目录。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">spring</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">servlet</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">multipart</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">location</span>: <span style="color:#ae81ff">/data/app</span>
</span></span></code></pre></div><h1 id="参考文章">参考文章</h1>
<p><a href="https://www.zhangbj.com/p/474.html">https://www.zhangbj.com/p/474.html</a></p>
        </div>
    
    
  
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<div id="gitalk-container" style="margin-top:40px"></div>
<script>
  (function(){
    var gitalk = new Gitalk({
      clientID: '3181fd94e501cc5db0ad',
      clientSecret: 'af1dab79dae02c69296e6615bfcecf47fc8615ee',
      repo: 'margropcomment.margrop.io',
      owner: 'margrop',
      admin: "[\"margrop\"]",
      id: '9fd4d4ae1e3e91ee43b1dcb17e9291695cd9431f',
      distractionFreeMode: false
    });
    gitalk.render('gitalk-container');
  })();
</script>
  



    <script type="text/javascript" src="https://js.users.51.la/21044367.js"></script>
</body>
</html>
