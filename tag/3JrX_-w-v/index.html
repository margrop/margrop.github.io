<html>
  <head>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>pve | 魔都水滴</title>
<link rel="shortcut icon" href="https://blog.margrop.net/favicon.ico?v=1772278123220">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://blog.margrop.net/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="pve | 魔都水滴 - Atom Feed" href="https://blog.margrop.net/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">


<script async src="https://www.googletagmanager.com/gtag/js?id=G-3J2W592DHJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3J2W592DHJ');
</script>


<script type="text/javascript" src="https://js.users.51.la/21044367.js"></script>
<script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id: "1vVTUWl7zoRjnKXi",ck: "1vVTUWl7zoRjnKXi"})</script>
<script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script>
<script>
  new LingQue.Monitor().init({id:"202teQt8THXwqyve"});
</script>
  <meta name="description" content="Programmer, Javaer, Father, Geeker, Huster, Acmer, Wower, Gamer" />
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://blog.margrop.net">
  <img class="avatar" src="https://blog.margrop.net/images/avatar.png?v=1772278123220" alt="">
  </a>
  <h1 class="site-title">
    魔都水滴
  </h1>
  <p class="site-description">
    A Programmer, A Javaer, A Father, A Geeker, A Huster, A Acmer, A Wower, A Player
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
      
        <a href="https://download.margrop.net" class="menu" target="_blank">
          下载
        </a>
      
    
      
        <a href="/post/favorites" class="menu">
          Link
        </a>
      
    
      
        <a href="/post/github-project-stars" class="menu">
          Github
        </a>
      
    
      
        <a href="https://github-mirrors.margrop.net" class="menu" target="_blank">
          Github加速
        </a>
      
    
      
        <a href="https://docker-mirrors.margrop.net" class="menu" target="_blank">
          Docker加速
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/margrop" target="_blank">
          <i class="ri-github-line"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="current-tag-container">
            <h2 class="title">
                标签：# pve
            </h2> 
        </div>
        <div class="post-container">
  
    <article class="post">
      <a href="https://blog.margrop.net/post/proxmoxve-upgrade-from-8-to-9/">
        <h2 class="post-title">ProxmoxVE Upgrade from 8 to 9 如何升级到PVE9</h2>
      </a>
      <div class="post-info">
        <span>
          2025-08-06
        </span>
        <span>
          2 min read
        </span>
        
          <a href="https://blog.margrop.net/tag/0dTtT9kKc2/" class="post-tag">
            # trixie
          </a>
        
          <a href="https://blog.margrop.net/tag/arxtNwGvUL/" class="post-tag">
            # upgrade
          </a>
        
          <a href="https://blog.margrop.net/tag/3JrX_-w-v/" class="post-tag">
            # pve
          </a>
        
          <a href="https://blog.margrop.net/tag/sqHvGSMMZh/" class="post-tag">
            # Proxmox VE
          </a>
        
      </div>
      
      <div class="post-abstract">
        <pre><code class="language-plaintext">参考文档：https://pve.proxmox.com/wiki/Upgrade_from_8_to_9
</code></pre>
<h3 id="升级前准备">升级前准备</h3>
<pre><code class="language-bash">pve8to9

apt update
apt dist-upgrade
pveversion

#reboot 建议更新完毕后重启1次
</code></pre>

      </div>
    </article>
  
    <article class="post">
      <a href="https://blog.margrop.net/post/how-to-quickly-configure-fail2ban-in-proxmox-ve/">
        <h2 class="post-title">在Proxmox VE中快速设置Fail2ban防止多次登录失败的有效方法</h2>
      </a>
      <div class="post-info">
        <span>
          2024-06-18
        </span>
        <span>
          2 min read
        </span>
        
          <a href="https://blog.margrop.net/tag/CXLksV7rb0/" class="post-tag">
            # fail2ban
          </a>
        
          <a href="https://blog.margrop.net/tag/4rp5THLHDl/" class="post-tag">
            # Linux
          </a>
        
          <a href="https://blog.margrop.net/tag/3JrX_-w-v/" class="post-tag">
            # pve
          </a>
        
          <a href="https://blog.margrop.net/tag/sqHvGSMMZh/" class="post-tag">
            # Proxmox VE
          </a>
        
      </div>
      
      <div class="post-abstract">
        <p>这里简要介绍了如何在Proxmox VE中设置Fail2ban以暂时阻止多次错误登录尝试的IP地址。</p>
<h3 id="安装fail2ban">安装Fail2ban</h3>
<p>在Proxmox VE主机上作为root执行以下命令：</p>
<pre><code class="language-sh">apt update
apt install fail2ban
</code></pre>
<h3 id="配置基础设置">配置基础设置</h3>
<p>建议使用<code>/etc/fail2ban/jail.local</code>文件，其设置优先于<code>jail.conf</code>。使用以下命令复制模板：</p>
<pre><code class="language-sh">cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local
</code></pre>

      </div>
    </article>
  
    <article class="post">
      <a href="https://blog.margrop.net/post/n5105-in-promox-ve-frequently-dead/">
        <h2 class="post-title">N5105 Promox VE 8.2版本，虚拟机频繁死机问题处理</h2>
      </a>
      <div class="post-info">
        <span>
          2024-05-04
        </span>
        <span>
          7 min read
        </span>
        
          <a href="https://blog.margrop.net/tag/sI3e1wHW-/" class="post-tag">
            # n5105
          </a>
        
          <a href="https://blog.margrop.net/tag/diAynPFsF6/" class="post-tag">
            # microcode
          </a>
        
          <a href="https://blog.margrop.net/tag/aWeI9Zuddw/" class="post-tag">
            # intel
          </a>
        
          <a href="https://blog.margrop.net/tag/3JrX_-w-v/" class="post-tag">
            # pve
          </a>
        
          <a href="https://blog.margrop.net/tag/sqHvGSMMZh/" class="post-tag">
            # Proxmox VE
          </a>
        
      </div>
      
      <div class="post-abstract">
        <h1 id="一-问题背景">一、问题背景</h1>
<p>最近五一各大PT网站开发注册，于是乎注册了几家网站，然后为了做新手任务，疯狂下载上传，作为软路由的 N5105 、iKuai 在长时间高负载时，虚拟机会出现随机性的死机，CPU长期保持100%，只能杀掉再重启虚拟机，相当影响完成新手任务。死机了几次后终于受不了了，看网上各大同仁，发现同样问题不在少数。</p>
<p>下面是CSDN其他同仁的问题描述：</p>
<blockquote>
<p>使用 N5105 作为 HomeLab 的服务器；之前安装的 ESXi，使用 Ubuntu 22 的时候经常会出现 Ubuntu CPU 占用达到100%，然后死机；但是其他的虚拟机都没有问题，因为对 Linux 并不熟，查看了 ESXi 和 Ubuntu 日志并没有异常；后面安装黑群晖一直失败，因此换到了 Proxmox VE</p>
</blockquote>
<blockquote>
<p>换到 PVE 后依然存在同样的问题，以为是服务的问题，于是给 Docker 容器添加了资源限制，无效后迁移到了 CentOS 部署，发现还是同样的问题；并且越来越频繁，从一天一次变成了几小时一次，几乎无法使用</p>
</blockquote>

      </div>
    </article>
  
    <article class="post">
      <a href="https://blog.margrop.net/post/install-min-k8s-using-minikube-on-pve/">
        <h2 class="post-title">使用 Minikube 安装最小化k8s环境</h2>
      </a>
      <div class="post-info">
        <span>
          2024-04-30
        </span>
        <span>
          3 min read
        </span>
        
          <a href="https://blog.margrop.net/tag/eOC20y1kb/" class="post-tag">
            # k8s
          </a>
        
          <a href="https://blog.margrop.net/tag/3JrX_-w-v/" class="post-tag">
            # pve
          </a>
        
          <a href="https://blog.margrop.net/tag/sqHvGSMMZh/" class="post-tag">
            # Proxmox VE
          </a>
        
      </div>
      
      <div class="post-abstract">
        <p>在 Proxmox VE（一种基于 Debian 的虚拟化环境）上部署 Minikube 需要考虑 Proxmox 的特性，它本质上是一个虚拟机和容器管理平台。您将需要在 Proxmox VE 上创建一个虚拟机（VM），然后在该 VM 中安装 Minikube。以下是详细的步骤：</p>

      </div>
    </article>
  
    <article class="post">
      <a href="https://blog.margrop.net/post/pve-7-upgrade-to-8/">
        <h2 class="post-title">ProxmoxVE 7.4升级到8.0，详细步骤</h2>
      </a>
      <div class="post-info">
        <span>
          2023-07-08
        </span>
        <span>
          4 min read
        </span>
        
          <a href="https://blog.margrop.net/tag/3JrX_-w-v/" class="post-tag">
            # pve
          </a>
        
          <a href="https://blog.margrop.net/tag/sqHvGSMMZh/" class="post-tag">
            # Proxmox VE
          </a>
        
      </div>
      
      <div class="post-abstract">
        <h1 id="第一步详细阅读官方文档">第一步：详细阅读官方文档</h1>
<p>https://pve.proxmox.com/wiki/Upgrade_from_7_to_8</p>
<p><strong>注意：</strong><br>
如果远程使用ssh连接的话，建议先使用<code>screen</code>命令，避免网络不稳定，操作中断导致的各种问题</p>
<h1 id="第二步升级到最新的-74-版本">第二步：升级到最新的 7.4 版本</h1>
<pre><code>apt update -y &amp;&amp; apt dist-upgrade -y

sed -i_orig &quot;s/data.status === 'Active'/true/g&quot; /usr/share/pve-manager/js/pvemanagerlib.js
sed -i_orig &quot;s/if (res === null || res === undefined || \!res || res/if(/g&quot; /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js
sed -i_orig &quot;s/.data.status.toLowerCase() !== 'active'/false/g&quot; /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js
systemctl restart pveproxy

pveversion
</code></pre>
<p>最新的版本是 7.4.15</p>

      </div>
    </article>
  
    <article class="post">
      <a href="https://blog.margrop.net/post/pve-corntab-restart-vm/">
        <h2 class="post-title">PVE对特定容器定时重启</h2>
      </a>
      <div class="post-info">
        <span>
          2023-03-12
        </span>
        <span>
          1 min read
        </span>
        
          <a href="https://blog.margrop.net/tag/tuZmgPkrB/" class="post-tag">
            # pro
          </a>
        
          <a href="https://blog.margrop.net/tag/MJ-EKdaAGl/" class="post-tag">
            # crontab
          </a>
        
          <a href="https://blog.margrop.net/tag/Lu6xgW8mqO/" class="post-tag">
            # vm
          </a>
        
          <a href="https://blog.margrop.net/tag/3JrX_-w-v/" class="post-tag">
            # pve
          </a>
        
      </div>
      
      <div class="post-abstract">
        <h1 id="背景">背景</h1>
<ul>
<li>由于观测到<code>HomeAssistant</code>这台<code>VM</code>的内存占用总是随着时间的推移而增加，然后最终会<code>OOM</code>，且无论升级了多少个版本也是如此，推测<code>HomeAssistant</code>有内存泄漏问题</li>
</ul>
<h1 id="解决方案">解决方案</h1>
<ul>
<li>在虚拟机层面，对该<code>VM</code>进行定期重启（每天一次）</li>
<li>登录到<code>PVE</code>所在的服务器</li>
<li>执行<code>crontab -e</code>，并输入下面命令</li>
</ul>
<pre><code>PATH=/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin

0 12 * * * qm stop 2007 ; sleep 10 ; qm start 2007
</code></pre>
<ul>
<li>注：命令中的<code>2007</code>是vmid，即<code>VM</code>的全局唯一ID</li>
</ul>

      </div>
    </article>
  
    <article class="post">
      <a href="https://blog.margrop.net/post/proxmox-ve-daily-maintain/">
        <h2 class="post-title">Proxmox VE 9.0 日常维护，去掉未订阅的提示，和设置国内源——2025年8月6日更新</h2>
      </a>
      <div class="post-info">
        <span>
          2023-02-26
        </span>
        <span>
          11 min read
        </span>
        
          <a href="https://blog.margrop.net/tag/3JrX_-w-v/" class="post-tag">
            # pve
          </a>
        
          <a href="https://blog.margrop.net/tag/sqHvGSMMZh/" class="post-tag">
            # Proxmox VE
          </a>
        
          <a href="https://blog.margrop.net/tag/8fo9pO_J_6/" class="post-tag">
            # pvekclean
          </a>
        
      </div>
      
      <div class="post-abstract">
        <h1 id="移除未使用的linux内核">移除未使用的Linux内核</h1>
<ul>
<li>若不存在<code>pvekclean</code>，请先安装</li>
</ul>
<pre><code class="language-bash">git clone https://github.com/jordanhillis/pvekclean.git
cd pvekclean
chmod +x pvekclean.sh
</code></pre>
<p>安装完成后执行<code>pvekclean</code>即可</p>
<pre><code class="language-bash">./pvekclean.sh
</code></pre>
<h1 id="日常软件更新命令">日常软件更新命令：</h1>
<pre><code class="language-bash">apt update -y &amp;&amp; apt dist-upgrade -y
</code></pre>
<h1 id="更新pve并安装常用软件">更新PVE，并安装常用软件</h1>
<pre><code class="language-bash">apt-get update &amp;&amp; apt-get install vim lrzsz unzip net-tools curl screen tmux uuid-runtime git -y &amp;&amp; apt dist-upgrade -y
</code></pre>

      </div>
    </article>
  
    <article class="post">
      <a href="https://blog.margrop.net/post/home-network-architecture-based-pve-and-soft-route-and-nas/">
        <h2 class="post-title">基于 PVE + 软路由 + NAS的家里网络架构梳理（面向技术人员）</h2>
      </a>
      <div class="post-info">
        <span>
          2021-09-03
        </span>
        <span>
          1 min read
        </span>
        
          <a href="https://blog.margrop.net/tag/5LlRD96SJg/" class="post-tag">
            # 电信
          </a>
        
          <a href="https://blog.margrop.net/tag/sqgZQuoadw/" class="post-tag">
            # 光猫
          </a>
        
          <a href="https://blog.margrop.net/tag/PD1IpRpihr/" class="post-tag">
            # NAS
          </a>
        
          <a href="https://blog.margrop.net/tag/Fn1pe4dPit/" class="post-tag">
            # router
          </a>
        
          <a href="https://blog.margrop.net/tag/3JrX_-w-v/" class="post-tag">
            # pve
          </a>
        
          <a href="https://blog.margrop.net/tag/E9Rv5qjae/" class="post-tag">
            # network
          </a>
        
      </div>
      
      <div class="post-abstract">
        <h1 id="家庭网络概述">家庭网络概述</h1>
<p>家庭网络，不会像正规的虚拟化平台那样，搞『业务平面』『管理平面』『数据平面』三个平面分离。<br>
家庭网络需要的是方便，那么上面说的三个平面，就需要融合在一起共用网络，才能管理方便。<br>
家庭网络的安全也十分重要，谁也不希望家里的网络大门就一直对外敞开着。</p>
<h1 id="准备硬件设备">准备硬件设备</h1>
<ul>
<li>电信光猫（目前只有电信宽带，才有可能要到公网IP）</li>
<li>多网口工控机（软路由，性能不要太差）</li>
<li>普通台式机或服务器（能保证7x24小时开机就行）</li>
<li>AC + AP（AC 和 AP需要同一个品牌，考虑到 5G WIFI 穿墙性能极差，建议每个房间都配1个5G AP）</li>
<li>NAS（建议白裙或黑裙）</li>
<li>网线</li>
<li>U盘</li>
<li>可插网线的笔记本电脑（配置网络用）</li>
</ul>

      </div>
    </article>
  
    <article class="post">
      <a href="https://blog.margrop.net/post/upgrade-from-pve-6.x-to-7.0/">
        <h2 class="post-title">如何从 Proxmox VE 6.4 升级到 Proxmox VE 7.0?</h2>
      </a>
      <div class="post-info">
        <span>
          2021-08-16
        </span>
        <span>
          3 min read
        </span>
        
          <a href="https://blog.margrop.net/tag/arxtNwGvUL/" class="post-tag">
            # upgrade
          </a>
        
          <a href="https://blog.margrop.net/tag/3JrX_-w-v/" class="post-tag">
            # pve
          </a>
        
      </div>
      
      <div class="post-abstract">
        <p>好久没关注 Proxmox VE 的官网。</p>
<p>直至前几天推荐 PVE  给同事使用时，才惊觉又升级大版本了。</p>
<p>作为升级强迫症患者，当然会选择立即升级到最新版本。</p>
<p>很早之前经历过从 PVE 5.x 升级到 6.0 的过程，现在又要开始 PVE 6.4 升级到 7.0。</p>
<p>总之，老老实实看官方教程就对了。</p>
<h1 id="下面是各个-pve-大版本升级的官方教程">下面是各个 PVE 大版本升级的官方教程：</h1>
<p><a href="https://pve.proxmox.com/wiki/Upgrade_from_6.x_to_7.0">Upgrade from Proxmox VE 6.x to 7.0</a></p>
<p><a href="https://pve.proxmox.com/wiki/Upgrade_from_5.x_to_6.0">Upgrade from Proxmox VE 5.x to 6.0</a></p>
<p><a href="https://pve.proxmox.com/wiki/Upgrade_from_4.x_to_5.0">Upgrade from Proxmox VE 4.x to 5.0</a></p>
<p><a href="https://pve.proxmox.com/wiki/Upgrade_from_3.x_to_4.0">Upgrade from Proxmox VE 3.x to 4.0</a></p>

      </div>
    </article>
  
    <article class="post">
      <a href="https://blog.margrop.net/post/how-to-install-jika-ac-in-pve/">
        <h2 class="post-title">Proxmox VE 环境下，如何安装集客AC虚拟机？</h2>
      </a>
      <div class="post-info">
        <span>
          2021-02-03
        </span>
        <span>
          2 min read
        </span>
        
          <a href="https://blog.margrop.net/tag/iS7B-Xsd5/" class="post-tag">
            # vhd
          </a>
        
          <a href="https://blog.margrop.net/tag/mOtZgbC7a_/" class="post-tag">
            # 漫游
          </a>
        
          <a href="https://blog.margrop.net/tag/7Td_SQUSg5/" class="post-tag">
            # 路由
          </a>
        
          <a href="https://blog.margrop.net/tag/fhUvTaUtV/" class="post-tag">
            # 虚拟机
          </a>
        
          <a href="https://blog.margrop.net/tag/gwiP0yd1h/" class="post-tag">
            # install
          </a>
        
          <a href="https://blog.margrop.net/tag/Hc6tRHLw1F/" class="post-tag">
            # 软路由
          </a>
        
          <a href="https://blog.margrop.net/tag/3JrX_-w-v/" class="post-tag">
            # pve
          </a>
        
          <a href="https://blog.margrop.net/tag/sqHvGSMMZh/" class="post-tag">
            # Proxmox VE
          </a>
        
          <a href="https://blog.margrop.net/tag/SnsVQ9Esk/" class="post-tag">
            # 集客
          </a>
        
          <a href="https://blog.margrop.net/tag/b4kuydk5Qg/" class="post-tag">
            # AC
          </a>
        
          <a href="https://blog.margrop.net/tag/fz9jIyUeuE/" class="post-tag">
            # AP
          </a>
        
      </div>
      
      <div class="post-abstract">
        <p>根据<a href="https://www.right.com.cn/forum/thread-1501038-1-1.html">恩山的集客AC AP扫盲贴</a>介绍：</p>
<blockquote>
<p>问：可以不用<code>AC</code>，直接两个<code>AP</code>连接主路由漫游么？<br>
答：可以的，但有<code>AC</code>的漫游效果比没有好；有<code>ac</code>在，漫游效果不会差的，集客的漫游不是简单的弱踢。有<code>ac</code>在，不管集客<code>ap</code>支持不支持<code>kvr</code>，都有很好的效果，因为<code>ac+ap</code>是主动漫游，主动漫游走的不是<code>kvr</code>协议，对客户端要求也很低。微<code>ac</code>只负责下发配置，不能主动漫游，漫游效果依赖客户端。</p>
</blockquote>

      </div>
    </article>
  
</div>

        <div class="pagination-container">
  
  
    <a href="https://blog.margrop.net/tag/3JrX_-w-v/page/2" class="next-page">下一页</a>
  
</div>

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://blog.margrop.net/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>
<script type="text/javascript" src="https://js.users.51.la/21044367.js"></script>

      </div>
    </div>
  </body>
</html>
